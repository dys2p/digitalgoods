{{define "content"}}
<h1>{{.Translate "purchase"}} {{.Purchase.InvoiceID}}</h1>
<p>{{.Translate "status"}}: {{.Translate (printf "%s%s" "status-" .Purchase.Status)}}</p>
{{with .PaysrvErr}}
	<p class="alert alert-danger">Unser Payserver lieferte eine Fehlermeldung: {{.}}</p>
{{end}}
{{if .Purchase.DeleteDate}}
	<p class="alert alert-warning">{{.Translate "info-delete"}} {{.Purchase.DeleteDateStr}}</p>
{{end}}
{{if or .IsNew .IsUnderdelivered}}
	<script>
		scheduleReload();
	</script>
	<noscript>
		<p>{{.Translate "javascript-reload"}}</p>
	</noscript>
{{end}}
<h2>{{.Translate "whats-next"}}</h2>
<p>
	<ol>
		<li>{{.Translate "next-1"}}</li>
		<!-- same as in order.html -->
		<li>{{.Translate "how-2"}} <code>{{.URL}}</code></li>
		<li>{{.Translate "how-3"}}</li>
		<li>{{.Translate "how-4"}}</li>
		<li>{{.Translate "how-5"}}</li>
		<!-- end -->
	</ol>
</p>
<p>
	<a class="btn btn-success" href="{{.CheckoutLink}}" target="_blank">{{.Translate "pay-link"}}</a>
</p>
<h2>{{.Translate "your-order"}}</h2>
<table class="table">
	<thead>
		<tr>
			<th>{{.Translate "product"}}</th>
			<th>{{.Translate "amount"}}</th>
			<th>{{.Translate "item-price"}}</th>
			<th>{{.Translate "sum"}}</th>
		</tr>
	</thead>
	<tbody>
		{{range .GroupedOrder}}
			{{if gt (len .Rows) 0}}
			<tr>
				<td colspan="4">
					{{with .Category}}
						<!-- same as in purchase.html -->
						<input style="display: none" type="checkbox" id="toggle-{{.ID}}">
						<label for="toggle-{{.ID}}">
							<strong>{{.Name}}</strong>
							({{$.Translate "click-more"}})
						</label>
						<style>
						#toggle-{{.ID}} ~ div {
							display: none;
						}
						#toggle-{{.ID}}:checked ~ div {
							display: block;
						}
						</style>
						<div class="mt-2 mb-1">
							{{.Translate $.Language}}
						</div>
						<!-- end -->
					{{end}}
				</td>
			</tr>
				{{range .Rows}}
				<tr>
					<td>{{$.GetArticleName .ArticleID}}</td>
					<td>{{.Amount}}</td>
					<td>{{$.Translate "%.2f Euro" .ItemPriceEUR}}</td>
					<td>{{$.Translate "%.2f Euro" .SumEUR}}</td>
				</tr>
				{{end}}
			{{end}}
		{{end}}
		<tr>
			<td colspan="3">{{.Translate "overall-sum"}}</td>
			<td>{{.Translate "%.2f Euro" .Purchase.Ordered.SumEUR}}</td>
		</tr>
	</tbody>
</table>
<h2>{{.Translate "your-goods"}}</h2>
<table class="table">
	<thead>
		<tr>
			<th>{{.Translate "product"}}</th>
			<th>{{.Translate "delivery-date"}}</th>
			<th>{{.Translate "code"}}</th>
		</tr>
	</thead>
	<tbody>
		{{range .Purchase.Delivered}}
		<tr>
			<td>{{$.GetArticleName .ArticleID}}</td>
			<td>{{.DeliveryDateStr}}</td>
			{{if .Image}}
				<!-- use image as code -->
				<td><img src="{{.ImageSrc}}" /></td>
			{{else}}
				<!-- use ID as code -->
				<td>{{.ID}}</td>
			{{end}}
		</tr>
		{{end}}
		{{if .IsNew}}
		<tr>
			<td colspan="4">{{.Translate "info-waiting"}}</td>
		</tr>
		{{end}}
		{{if .IsUnderdelivered}}
		<tr>
			<td colspan="4">{{.Translate "sorry-underdelivered"}}</td>
		</tr>
		{{end}}
	</tbody>
</table>
{{end}}
