{{define "content"}}
<ol>
	<li>{{.Tr "Enter the amount and press „Order“."}}</li>
	<li>{{.Tr "Save the URL of your order. You will need it to access your goods."}}</li>
	<li>
		<a href="/{{.Lang}}/payment.html">{{.Tr "Pay your order."}}</a> ({{.Tr "Unpaid orders are deleted after 30 days."}})
		<ul>
			<li>{{.Tr "Monero (XMR) or Bitcoin (BTC): Your voucher codes are shown as soon as your payment is confirmed on the blockchain."}}</li>
			<li>{{.Tr "Cash: Send cash (we accept 20 currencies) to our office in Germany. We shred the letter after processing."}}</li>
			<li>{{.Tr "SEPA (Single Euro Payments Area) bank transfer to our German bank account. We manually check for new payments every day."}}</li>
		</ul>
	</li>
	<li>{{.Tr "Write down your codes. We will delete them 30 days after delivery."}}</li>
</ol>
{{if .OrderErr}}
	<div class="alert alert-danger">{{.Tr "Please select some products."}}</div>
{{end}}
<form method="post">
	<table class="table">
		<thead>
			<tr>
				<th>{{.Tr "Product"}}</th>
				<th></th>
				<th>{{.Tr "Amount"}}</th>
				<th>{{.Tr "In Stock"}}</th>
				<th>{{.Tr "Item Price"}}</th>
			</tr>
		</thead>
		{{range .Catalog}}
			<tbody class="table-group-divider">
				<tr>
					<td colspan="5">
						<strong><em>{{.TranslateName $.Lang}}</em></strong>
					</td>
				</tr>
				{{range .Articles}}
					<tr>
						<td colspan="5">
							<details>
								<summary><strong>{{.Name}}</strong> <span class="btn btn-outline-primary btn-sm ms-2">Read more</span></summary>
								<p class="my-2">{{.TranslateDescription $.Lang}}</p>
							</details>
						</td>
					</tr>
					{{range .Variants}}
						{{$variant := .}}
						{{range $.Stock.FeaturedCountryIDs $variant}}
							<tr>
								<td class="ps-4">{{$variant.Name}} {{if $.Stock.OnDemandOnly $variant .}}(on demand){{end}}</td>
								<td>{{if ne . "all"}}{{.}}{{end}}</td>
								<td>
									{{$max := $.Stock.Max $variant .}}
									{{if gt $max 0}}
										<input name="{{$variant.ID}}-{{.}}" type="number" min="0" max="{{$max}}" value="{{index $.Cart (printf "%s-%s" $variant.ID .)}}" class="form-control" style="width: calc(1.75rem + 2px + 5ch); padding-top: 0.1875rem; padding-bottom: 0.1875rem; margin-top: -0.1875rem; margin-bottom: -0.1875rem">
									{{end}}
								</td>
								<td>{{$.Stock.Get $variant .}}</td>
								<td>{{FmtEuro $variant.Price}}</td>
							</tr>
						{{end}}
						{{with $.Stock.OtherCountryIDs $variant}}
							{{$selectedCountryID := $.Tr "default-iso-country"}}
							{{with index $.OtherCountry $variant.ID}}
								{{$selectedCountryID = .}}
							{{end}}
							<tr>
								<td class="ps-4">{{$variant.Name}} {{if $variant.OnDemand}}(on demand){{end}}</td><!-- assuming other country IDs are always on demand -->
								<td>
									<select name="{{$variant.ID}}-other-country" class="form-select" style="padding-top: 0.1875rem; padding-bottom: 0.1875rem; margin-top: -0.1875rem; margin-bottom: -0.1875rem">
										<option>{{$.Tr "Select other country"}}</option><!-- autoselected if $selectedCountryID is empty -->
										{{range .}}
											<option {{if eq $selectedCountryID .}}selected{{end}} value="{{.}}">{{.}}</option>
										{{end}}
									</select>
								</td>
								<td>
									<input name="{{$variant.ID}}-other-amount" type="number" min="0" max="100" value="{{index $.Cart (printf "%s-other-amount" $variant.ID)}}" class="form-control" style="width: calc(1.75rem + 2px + 5ch); padding-top: 0.1875rem; padding-bottom: 0.1875rem; margin-top: -0.1875rem; margin-bottom: -0.1875rem">
								</td>
								<td>0</td><!-- assuming non-featured items are not on stock -->
								<td>{{FmtEuro $variant.Price}}</td>
							</tr>
						{{end}}
					{{end}}
				{{end}}
			</tbody>
		{{end}}
	</table>

	<div class="mt-4 mb-3">
		<label class="form-label">{{.Tr "Where do you live? (We have to ask that for tax reasons. It does not affect the price or the goods.)"}}</label>
		{{if .AvailableNonEU}}
			<div class="form-check {{if .CountryErr}}is-invalid{{end}}">
				<input class="form-check-input"  id="non-eu" type="radio" name="area" value="non-eu" {{if eq $.Area "non-eu"}}checked{{end}} onclick="document.getElementById('eu-country').disabled = true;">
				<label class="form-check-label" for="non-eu">{{.Tr "Not in the European Union"}}</label>
			</div>
		{{end}}
		{{if .AvailableEUCountries}}
			<div class="d-flex align-items-center">
				<div class="form-check me-2">
					<input class="form-check-input"  id="eu" type="radio" name="area" value="eu" {{if eq $.Area "eu"}}checked{{end}} onclick="document.getElementById('eu-country').disabled = false;">
					<label class="form-check-label" for="eu">{{.Tr "European Union"}}:</label>
				</div>
				<select class="form-select d-inline w-auto" id="eu-country" name="eu-country" onchange="document.getElementById('eu').checked = true;">
					<option class="text-secondary">{{.Tr "please select"}}</option>
					{{range $.AvailableEUCountries}}
						<option {{if eq $.EUCountry .Country}}selected{{end}} value="{{.Country}}">{{.Name}}</option>
					{{end}}
				</select>
			</div>
		{{end}}
		<div class="invalid-feedback">{{.Tr "Please select your country of residence."}}</div>
		<div class="form-text">{{.Tr "Options are limited by your IP address and browser language."}}</div>
	</div>

	{{template "captcha" .Captcha}}

	<div class="text-end">
		<input class="btn btn-success" type="submit" value="{{.Tr "Create order"}}">
	</div>
</form>
{{end}}
